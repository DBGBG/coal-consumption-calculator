# 燃煤发电基准煤耗计算程序

## 项目简介

本项目基于Excel文件"外部因素对煤耗的计算表1222.xlsx"的分析，开发了一个功能完整的基准煤耗计算程序。该程序能够准确实现Excel中的所有计算逻辑，接收必要的输入数据，自动完成基准煤耗数据的计算，并输出清晰的计算结果。

## 功能特性

- **完整的计算逻辑**：实现了Excel中的所有计算公式和修正因子
- **多工况支持**：支持正常、峰值、低谷、供热等不同运行工况
- **供热影响分析**：计算供热对煤耗的影响
- **详细的修正因子**：包括负荷率、温度、压力、湿度等修正因子
- **丰富的输出格式**：支持Excel、CSV等格式的结果导出
- **数据可视化**：生成修正因子分析图表

## 技术架构

- **开发语言**：Python 3.8+
- **核心库**：
  - numpy：数值计算
  - pandas：数据处理
  - matplotlib：数据可视化
  - openpyxl：Excel文件处理

## 项目结构

```
燃煤发电标煤耗/
├── coal_consumption/         # 核心计算模块
│   ├── __init__.py
│   ├── main.py              # 主程序入口
│   ├── input_handler.py     # 数据输入处理
│   ├── correction_factors.py # 修正因子计算
│   ├── coal_consumption.py  # 煤耗计算核心逻辑
│   ├── output_generator.py  # 结果输出
│   └── utils.py             # 工具函数
├── config.json              # 配置文件
├── README.md                # 项目说明
└── 外部因素对煤耗的计算表1222.xlsx  # 原始Excel文件
```

## 安装与使用

### 安装依赖

```bash
pip install numpy pandas matplotlib openpyxl
```

### 运行程序

```bash
python -m coal_consumption.main
```

### 配置参数

程序使用`config.json`文件中的默认参数，您可以根据需要修改这些参数：

- `base_load`：基准负荷率(%)
- `base_temperature`：基准温度(℃)
- `base_pressure`：基准压力(MPa)
- `coal_calorific_value`：煤的发热量(kJ/kg)
- `electricity_output`：发电量(MWh)
- `heating_output`：供热量(GJ)

## 计算原理

### 基本煤耗计算公式

```
煤耗 = (发电量 * 3600) / (煤的发热量 * 效率 * 管道效率)
```

### 修正因子计算

- **负荷率修正**：指数函数模型
- **温度修正**：线性模型
- **压力修正**：比例模型
- **湿度修正**：线性模型
- **供热修正**：综合模型

### 基准煤耗计算

基准煤耗 = 基本煤耗 × 综合修正因子

## 输出结果

程序运行后会生成以下文件：

- `煤耗计算结果.xlsx`：详细的计算结果（Excel格式）
- `煤耗计算结果.csv`：计算结果（CSV格式）
- `不同工况煤耗比较.xlsx`：不同运行工况的煤耗比较

## 示例输出

```
=== 燃煤发电基准煤耗计算程序 ===

1. 加载计算参数...
参数加载完成!
基准负荷率: 100.0%
基准温度: 25.0℃
基准压力: 16.7MPa

2. 计算基准煤耗...
计算完成!

3. 生成计算报告...
# 煤耗计算结果摘要

## 基本信息
基准煤耗: 48.20 g/kWh
基本煤耗: 139.28 g/kWh
综合修正因子: 0.3461

## 修正因子详情
load_factor: 1.0001
temperature: 1.0000
pressure: 1.0000
humidity: 1.0000
heating: 0.3461
steam_parameter: 1.0000
fuel: 1.0000

4. 导出计算结果...
结果已成功导出到: 煤耗计算结果.xlsx
结果已成功导出到: 煤耗计算结果.csv

=== 计算完成 ===
结果已导出到: 煤耗计算结果.xlsx 和 煤耗计算结果.csv
```

## 扩展与定制

### 添加新的修正因子

您可以在`correction_factors.py`文件中添加新的修正因子计算方法，然后在`coal_consumption.py`中集成到综合修正因子的计算中。

### 自定义输入输出

- **输入**：修改`input_handler.py`中的输入处理逻辑
- **输出**：修改`output_generator.py`中的输出格式

## 注意事项

1. 确保输入的参数值在合理范围内
2. 对于供热影响计算，需要正确设置供热参数
3. 煤的发热量应使用实际值以获得准确结果

## 故障排除

### 常见问题

- **计算结果异常**：检查输入参数的单位是否正确
- **导出失败**：确保目标目录有写入权限
- **依赖缺失**：运行`pip install -r requirements.txt`安装所有依赖

### 错误处理

程序包含基本的错误处理机制，对于无效输入会使用默认值。

## 许可证

本项目为内部使用工具，仅供参考和学习。

## 联系信息

如有问题或建议，请联系项目维护人员。
